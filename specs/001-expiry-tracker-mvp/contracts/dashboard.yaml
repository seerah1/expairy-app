openapi: 3.0.0
info:
  title: Expiry Tracker API - Dashboard
  version: 1.0.0
  description: Dashboard overview and statistics endpoints

servers:
  - url: http://localhost:3000/api
    description: Local development
  - url: https://api.expirytracker.com/api
    description: Production

paths:
  /dashboard:
    get:
      summary: Get dashboard overview for current user
      tags:
        - Dashboard
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Dashboard data retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      counts:
                        type: object
                        properties:
                          total:
                            type: integer
                            example: 45
                            description: Total items (food + documents)
                          expired:
                            type: integer
                            example: 3
                            description: Items with status "Expired"
                          expiringSoon:
                            type: integer
                            example: 7
                            description: Items with status "Expiring Soon"
                          safe:
                            type: integer
                            example: 35
                            description: Items with status "Safe"
                          foodItems:
                            type: integer
                            example: 30
                            description: Total food items
                          documents:
                            type: integer
                            example: 15
                            description: Total documents
                      upcomingExpirations:
                        type: array
                        description: Items expiring in next 7 days, sorted by expiry date
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 1
                            itemType:
                              type: string
                              enum: [food_item, document]
                              example: food_item
                            name:
                              type: string
                              example: Milk
                            category:
                              type: string
                              example: Dairy
                            expiryDate:
                              type: string
                              format: date
                              example: 2026-01-30
                            remainingDays:
                              type: integer
                              example: 7
                            status:
                              type: string
                              enum: [Expired, Expiring Soon, Safe]
                              example: Expiring Soon
                      recentlyAdded:
                        type: array
                        description: Last 5 items added
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 2
                            itemType:
                              type: string
                              enum: [food_item, document]
                              example: document
                            name:
                              type: string
                              example: Passport - AB1234567
                            expiryDate:
                              type: string
                              format: date
                              example: 2028-06-30
                            createdAt:
                              type: string
                              format: date-time
                              example: 2026-01-23T10:00:00Z
        '401':
          $ref: '#/components/responses/Unauthorized'

  /dashboard/statistics:
    get:
      summary: Get detailed statistics for current user
      tags:
        - Dashboard
      security:
        - bearerAuth: []
      parameters:
        - name: period
          in: query
          schema:
            type: string
            enum: [week, month, year]
            default: month
          description: Time period for statistics
      responses:
        '200':
          description: Statistics retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      period:
                        type: string
                        example: month
                      itemsAdded:
                        type: integer
                        example: 12
                        description: Items added in period
                      itemsExpired:
                        type: integer
                        example: 5
                        description: Items that expired in period
                      notificationsSent:
                        type: integer
                        example: 18
                        description: Notifications sent in period
                      categoryBreakdown:
                        type: array
                        description: Food items by category
                        items:
                          type: object
                          properties:
                            category:
                              type: string
                              example: Dairy
                            count:
                              type: integer
                              example: 8
                      documentTypeBreakdown:
                        type: array
                        description: Documents by type
                        items:
                          type: object
                          properties:
                            type:
                              type: string
                              example: Passport
                            count:
                              type: integer
                              example: 2
        '401':
          $ref: '#/components/responses/Unauthorized'

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  responses:
    Unauthorized:
      description: Unauthorized - Invalid or missing token
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              message:
                type: string
                example: Unauthorized
